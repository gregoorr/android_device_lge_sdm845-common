#============= fsck ==============
allow fsck self:capability { kill };

#============= hal_camera_default ==============
allow hal_camera_default mnt_vendor_file:dir ra_dir_perms;
allow hal_camera_default mnt_vendor_file:file rw_file_perms;
allow hal_camera_default mnt_vendor_file:file create;
set_prop(hal_camera_default, vendor_default_prop)
allow hal_camera_default sysfs:file rw_file_perms;
allow hal_camera_default default_prop:file { getattr open read };

#============= hal_lineage_livedisplay_qti ==============
allow hal_lineage_livedisplay_qti sysfs:file rw_file_perms;

#============= hal_graphics_composer_default ==============
get_prop(hal_graphics_composer_default, vendor_dpps_prop)

#============= hal_health_default ==============
allow hal_health_default sysfs:file r_file_perms;

#============= hal_power_default ==============
allow hal_power_default sysfs:file w_file_perms;

#============= hal_sensors_default ==============
allow hal_sensors_default proc:file r_file_perms;
allow hal_sensors_default sysfs:file r_file_perms;

#============= hal_soter_qti ==============
allow hal_soter_qti vfat:dir search;

#============= init ==============
allow init mnt_product_file:dir mounton;
allow init oemfs:dir mounton;
allow init vendor_file:file execute;

#============= kernel ==============
allow kernel block_device:dir search;

#============= qti_init_shell ==============
allow qti_init_shell sensors_vendor_data_file:dir search;
allow qti_init_shell sysfs_leds:file setattr;
allow qti_init_shell vfat:dir search;
allow qti_init_shell vfat:dir read;
allow qti_init_shell vfat:file r_file_perms;
allow qti_init_shell proc_sysctl_schedboost:file w_file_perms;
allow qti_init_shell sysfs:file write;

#============= qtidataservices_app ==============
# neverallow
#allow qtidataservices_app self:socket create_socket_perms;
allow qtidataservices_app self:socket create_socket_perms_no_ioctl;

#============= rfs_access ==============
allow rfs_access vfat:dir search;
allow rfs_access vfat:file r_file_perms;

#============= thermal-engine ==============
allow thermal-engine sysfs:dir open;

#============= ueventd ==============
allow ueventd metadata_file:dir search;
allow ueventd vfat:dir search;
allow ueventd vfat:file r_file_perms;

#============= vendor_init ==============
allow vendor_init device:file create_file_perms;
get_prop(vendor_init, persist_debug_prop)
set_prop(vendor_init, bluetooth_prop)
set_prop(vendor_init, camera_prop)
set_prop(vendor_init, freq_prop)
set_prop(vendor_init, vendor_ssr_prop)
set_prop(vendor_init, default_prop)
allow vendor_init block_device:blk_file r_file_perms;
allow vendor_init tombstone_data_file:dir getattr;

#============= vendor_pd_mapper ==============
allow vendor_pd_mapper vfat:dir r_dir_perms;
allow vendor_pd_mapper vfat:file r_file_perms;

#============= wcnss_service ==============
allow wcnss_service vendor_shell_exec:file execute_no_trans;
allow wcnss_service kmsg_device:chr_file w_file_perms;
allow wcnss_service rootfs:dir r_dir_perms;

#============= zygote ==============
allow zygote self:capability kill;

#============= cnd ==============
allow cnd default_android_hwservice:hwservice_manager find;

#============= hal_fingerprint_default ==============
allow hal_fingerprint_default vfat:dir search;
allow hal_fingerprint_default vfat:file r_file_perms;

#============= hal_light_default ==============
allow hal_light_default sysfs:file rw_file_perms;

#============= init ==============
allow init unlabeled:dir mounton;

add_hwservice(init, default_android_hwservice)
add_hwservice(init, hal_lineage_touch_hwservice)
add_hwservice(init, hal_nfc_hwservice)
add_hwservice(init, hal_nxpnfc_hwservice)
add_hwservice(init, hal_power_stats_hwservice)
add_hwservice(init, hal_thermal_hwservice)
add_hwservice(init, hal_vibrator_hwservice)
add_hwservice(init, hidl_base_hwservice)
add_service(init, hal_contexthub_service)
allow init device:chr_file rw_file_perms;
allow init hal_audio_hwservice:hwservice_manager find;
allow init proc:file write;
allow init same_process_hal_file:file execute;
allow init self:socket create;
allow init sysfs:file { open write };
allow init sysfs_rpm:file open;
allow init sysfs_system_sleep_stats:file open;
allow init vendor_file:file execute_no_trans;
allow init vendor_toolbox_exec:file execute_no_trans;
allow init vfat:file r_file_perms;
allow init vndbinder_device:chr_file rw_file_perms;
binder_call(init, hwservicemanager)
binder_call(init, nfc)
binder_call(init, sysfs)
binder_call(init, vndservicemanager)
binder_call(init, hal_audio_default)

#============= hal_audio_default ==============
allow hal_audio_default unlabeled:dir search;
set_prop(hal_audio_default, vendor_default_prop)
allow hal_audio_default oemfs:dir search;

#============= rild ==============
get_prop(rild, boot_status_prop)
add_hwservice(rild, default_android_hwservice)
binder_call(rild, init)
set_prop(rild, vendor_default_prop)
binder_call(rild, hal_lgdata_default)

#============= qti_init_shell ==============
allow qti_init_shell vendor_file:file entrypoint;

#============= network_stack ==============
allow network_stack fs_bpf:file { getattr open read write };

#============= nfc ==============
binder_call(nfc, init)

#============= sensors ==============
allow sensors mnt_vendor_file:file { r_file_perms create };

#============= system_app ==============
binder_call(system_app, init)

#============= tee ==============
allow tee mnt_vendor_file:dir { add_name remove_name write };
allow tee mnt_vendor_file:file create_file_perms;

#============= vold ==============
allow vold mnt_vendor_file:dir r_dir_perms;

#============= system_server ==============
binder_call(system_server, init)
allow system_server proc:file r_file_perms;
allow system_server sysfs:file r_file_perms;
allow system_server vendor_file:file r_file_perms;

#============= hal_power_stats_default ==============
vndbinder_use(hal_power_stats)
allow hal_power_stats_default sysfs_rpm:file r_file_perms;
allow hal_power_stats_default sysfs_system_sleep_stats:file r_file_perms;
binder_call(hal_power_stats_default, vndservicemanager)
get_prop(hal_power_stats_default, wifi_hal_prop)
add_service(hal_power_stats_default, default_android_vndservice)

#============= hal_lineage_touch_default ==============
allow hal_lineage_touch_default sysfs:file rw_file_perms;

#============= hal_nfc_default ==============
allow hal_nfc_default device:chr_file rw_file_perms;
allow init sysfs_power:file w_file_perms;
