type zramswap, domain;
type zramswap_exec, exec_type, vendor_file_type, file_type;

init_daemon_domain(zramswap);

# /dev/block/zram0
allow zramswap block_device:dir r_dir_perms;
allow zramswap vendor_toolbox_exec:file execute_no_trans;
allow zramswap swap_block_device:blk_file rw_file_perms;

# Allow /sys access to write zram disksize
allow zramswap sysfs_zram:dir r_dir_perms;
allow zramswap sysfs_zram:file rw_file_perms;

allow zramswap proc:file rw_file_perms;

# To read /proc/meminfo
allow zramswap proc_meminfo:file r_file_perms;

# /proc/sys/vm/overcommit_memory
allow zramswap proc_overcommit_memory:file w_file_perms;

allow zramswap rootfs:dir r_dir_perms;

allow zramswap self:capability sys_admin;
